<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FMA - 極簡記帳</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Inter', sans-serif; }
        input[type=number]::-webkit-inner-spin-button, 
        input[type=number]::-webkit-outer-spin-button { 
            -webkit-appearance: none; 
            margin: 0; 
        }
    </style>
</head>
<body class="bg-gray-50 text-gray-800 min-h-screen">

    <div class="max-w-md mx-auto min-h-screen bg-white shadow-2xl overflow-hidden relative">
        
        <header class="bg-white px-6 py-5 flex items-center justify-center sticky top-0 z-10 border-b border-gray-100">
            <div class="w-8 h-8 bg-blue-600 rounded-lg flex items-center justify-center text-white font-bold mr-2 shadow-blue-200 shadow-lg">F</div>
            <h1 class="text-xl font-extrabold tracking-tight text-gray-900">FMA</h1>
        </header>

        <main class="p-6 pb-24 space-y-6">
            
            <div class="bg-gradient-to-br from-blue-600 to-indigo-700 text-white rounded-2xl p-6 shadow-xl shadow-blue-200 relative overflow-hidden">
                <div class="absolute top-0 right-0 -mt-4 -mr-4 w-24 h-24 bg-white opacity-10 rounded-full blur-xl"></div>
                
                <div class="relative z-10">
                    <div class="text-blue-100 text-xs font-medium uppercase tracking-wider mb-1">本月結餘</div>
                    <div class="text-4xl font-bold mb-6 tracking-tight" id="display-balance">$ 0</div>

                    <div class="flex gap-4">
                        <div class="flex-1 bg-white/10 backdrop-blur-sm rounded-xl p-3 border border-white/10">
                            <div class="flex items-center gap-2 mb-1">
                                <div class="w-4 h-4 bg-green-400 rounded-full flex items-center justify-center">
                                    <svg class="w-3 h-3 text-green-900" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="3" d="M19 14l-7 7m0 0l-7-7m7 7V3"></path></svg>
                                </div>
                                <span class="text-xs text-blue-100">總收入</span>
                            </div>
                            <div class="font-semibold text-lg" id="display-income">0</div>
                        </div>
                        <div class="flex-1 bg-white/10 backdrop-blur-sm rounded-xl p-3 border border-white/10">
                            <div class="flex items-center gap-2 mb-1">
                                <div class="w-4 h-4 bg-red-400 rounded-full flex items-center justify-center">
                                    <svg class="w-3 h-3 text-red-900" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="3" d="M5 10l7-7m0 0l7 7m-7-7v18"></path></svg>
                                </div>
                                <span class="text-xs text-blue-100">總支出</span>
                            </div>
                            <div class="font-semibold text-lg" id="display-expense">0</div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="bg-white rounded-xl border border-gray-100 shadow-sm p-4">
                <h2 class="text-xs font-bold text-gray-400 uppercase mb-3">快速記帳</h2>
                <form id="transaction-form" class="flex flex-col gap-3">
                    <div class="flex gap-2">
                        <select id="inp-type" class="bg-gray-50 border border-gray-200 text-gray-700 rounded-lg px-3 py-2.5 text-sm font-medium focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                            <option value="expense">支出</option>
                            <option value="income">收入</option>
                        </select>
                        <input type="text" id="inp-title" placeholder="項目 (如: 午餐)" class="flex-1 bg-gray-50 border border-gray-200 text-gray-900 rounded-lg px-4 py-2.5 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all" required>
                    </div>
                    <div class="flex gap-2">
                        <input type="number" id="inp-amount" placeholder="金額" class="flex-1 bg-gray-50 border border-gray-200 text-gray-900 rounded-lg px-4 py-2.5 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all" required>
                        <button type="submit" class="bg-blue-600 hover:bg-blue-700 active:bg-blue-800 text-white px-5 py-2.5 rounded-lg font-medium text-sm shadow-md shadow-blue-200 transition-colors flex items-center gap-1">
                            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"></path></svg>
                            新增
                        </button>
                    </div>
                </form>
            </div>

            <div>
                <div class="flex items-center justify-between mb-3">
                    <h2 class="text-lg font-bold text-gray-800">最近交易</h2>
                    <button onclick="clearAll()" class="text-xs text-red-400 hover:text-red-600">重置資料</button>
                </div>
                
                <div id="transaction-list" class="space-y-3"></div>
                
                <div id="empty-state" class="hidden py-10 text-center">
                    <div class="inline-flex items-center justify-center w-16 h-16 rounded-full bg-gray-100 mb-3">
                        <svg class="w-8 h-8 text-gray-300" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-3 7h3m-3 4h3m-6-4h.01M9 16h.01"></path></svg>
                    </div>
                    <p class="text-gray-400 text-sm">目前沒有紀錄<br>試著新增一筆吧！</p>
                </div>
            </div>

        </main>
    </div>

    <script>
        // === 1. 初始化資料 (更新儲存空間名稱為 fma_data) ===
        // 如果改了名字，我們使用新的儲存空間，舊資料會暫時清空
        let transactions = JSON.parse(localStorage.getItem('fma_data')) || [
            { id: 1, title: '歡迎使用 FMA', amount: 0, type: 'income', date: new Date().toLocaleDateString() }
        ];

        const form = document.getElementById('transaction-form');
        const listEl = document.getElementById('transaction-list');
        const emptyState = document.getElementById('empty-state');
        const balanceEl = document.getElementById('display-balance');
        const incomeEl = document.getElementById('display-income');
        const expenseEl = document.getElementById('display-expense');

        // 更新畫面
        function updateUI() {
            listEl.innerHTML = '';
            let totalIncome = 0;
            let totalExpense = 0;

            transactions.forEach(t => {
                if (t.type === 'income') {
                    totalIncome += Number(t.amount);
                } else {
                    totalExpense += Number(t.amount);
                }
            });

            const balance = totalIncome - totalExpense;

            balanceEl.innerText = `$ ${balance.toLocaleString()}`;
            incomeEl.innerText = `+ ${totalIncome.toLocaleString()}`;
            expenseEl.innerText = `- ${totalExpense.toLocaleString()}`;

            if (transactions.length === 0) {
                emptyState.classList.remove('hidden');
            } else {
                emptyState.classList.add('hidden');
                
                transactions.sort((a, b) => b.id - a.id).forEach(t => {
                    const isIncome = t.type === 'income';
                    const sign = isIncome ? '+' : '-';
                    const colorClass = isIncome ? 'text-green-600' : 'text-gray-800';
                    const iconBg = isIncome ? 'bg-green-100 text-green-600' : 'bg-red-100 text-red-500';
                    const iconSvg = isIncome 
                        ? '<svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6"></path></svg>'
                        : '<svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20 12H4"></path></svg>';

                    const item = document.createElement('div');
                    item.className = 'bg-white p-4 rounded-xl shadow-sm border border-gray-100 flex items-center justify-between group hover:border-blue-200 transition-all';
                    item.innerHTML = `
                        <div class="flex items-center gap-3">
                            <div class="w-10 h-10 rounded-full ${iconBg} flex items-center justify-center shrink-0">
                                ${iconSvg}
                            </div>
                            <div>
                                <p class="font-bold text-gray-800 text-sm">${t.title}</p>
                                <p class="text-xs text-gray-400">${t.date}</p>
                            </div>
                        </div>
                        <div class="flex items-center gap-3">
                            <span class="font-bold text-lg ${colorClass}">
                                ${sign} ${Number(t.amount).toLocaleString()}
                            </span>
                            <button onclick="deleteTransaction(${t.id})" class="w-8 h-8 flex items-center justify-center rounded-full text-gray-300 hover:bg-red-50 hover:text-red-500 transition-colors">
                                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path></svg>
                            </button>
                        </div>
                    `;
                    listEl.appendChild(item);
                });
            }

            // 更新儲存名稱為 fma_data
            localStorage.setItem('fma_data', JSON.stringify(transactions));
        }

        function addTransaction(e) {
            e.preventDefault();
            
            const title = document.getElementById('inp-title').value;
            const amount = document.getElementById('inp-amount').value;
            const type = document.getElementById('inp-type').value;

            if (title.trim() === '' || amount.trim() === '') {
                alert('請輸入完整的項目與金額！');
                return;
            }

            const newTx = {
                id: Date.now(),
                title: title,
                amount: Number(amount),
                type: type,
                date: new Date().toISOString().split('T')[0]
            };

            transactions.push(newTx);
            updateUI();

            document.getElementById('inp-title').value = '';
            document.getElementById('inp-amount').value = '';
            document.getElementById('inp-title').focus();
        }

        function deleteTransaction(id) {
            if(confirm('確定要刪除這筆紀錄嗎？')) {
                transactions = transactions.filter(t => t.id !== id);
                updateUI();
            }
        }

        function clearAll() {
            if(confirm('警告：這將刪除所有資料且無法復原！確定嗎？')) {
                transactions = [];
                updateUI();
            }
        }

        form.addEventListener('submit', addTransaction);

        updateUI();

    </script>
</body>
</html>
